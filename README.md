# УВМ на допуск (Вариант №20)

## Описание проекта
Проект реализует учебную виртуальную машину (УВМ) варианта 20 и инструменты для работы с ней:
- **Ассемблер** — преобразует программу в JSON в бинарный формат УВМ
- **Интерпретатор** — исполняет бинарный код УВМ и формирует дамп памяти
- **Tkinter GUI** — позволяет визуально редактировать JSON-программы, ассемблировать и запускать их
- **Web GUI на Flask** — предоставляет редактор программы, вывод байткода, IR и дампа памяти через браузер
- **Тестовые программы и дампы** — примеры использования load_const, read_value, write_value и max

## Язык ассемблера УВМ
Ассемблер использует человекочитаемый JSON-синтаксис. Каждая инструкция представляет собой объект с ключами:
- `op` — операция
- `B`, `C`, `D` — аргументы (для некоторых инструкций `D` необязателен)

### Поддерживаемые инструкции
**Загрузка константы в память. `load_const`**  
Формат: `{ "op": "load_const", "B": <адрес>, "C": <значение> }`  
Описание: сохранить число `C` в ячейку `B`.

**Чтение значения из памяти по адресу. `read_value`**  
Формат: `{ "op": "read_value", "B": <адрес_назначения>, "C": <адрес_источника> }`  
Описание: `memory[B] = memory[C]`

**Запись значения в память по адресу. `write_value`**  
Формат: `{ "op": "write_value", "B": <адрес_источника>, "C": <адрес_назначения> }`  
Описание: `memory[C] = memory[B]`

**Операция сравнения двух значений и запись максимума. `max`**  
Формат: `{ "op": "max", "B": <адрес_назначения>, "C": <адрес_1>, "D": <адрес_2> }`  
Описание:  
```python
val1 = memory[C]
val2 = memory[D]
memory[B] = max(val1, val2)

Размер команд
Команда	Размер	Описание
load_const	8 байт	opcode + B + C (по 20 бит)
read_value	8 байт	opcode + B + C (по 20 бит)
write_value	8 байт	opcode + B + C (по 20 бит)
max	8 байт	opcode + B + C + D (по 20 бит)

Структура проекта
variant20/
│
├── json/              # JSON-программы
├── dump/              # CSV дампы
├── templates/         # HTML-шаблоны для Web GUI
│   └── index.html
├── uvm_asm.py         # Ассемблер
├── uvm_interp.py      # Интерпретатор
├── uvm_gui.py         # Tkinter GUI
├── uvm_gui_web.py     # Flask Web GUI
└── README.md          # Документация

Запуск ассемблера
python uvm_asm.py -i json/example1.json -o dump/example1.bin -t

-i — путь к JSON

-o — выходной бинарный файл

-t — тестовый режим (вывод IR и байткода)

Запуск интерпретатора
python uvm_interp.py -i dump/example1.bin -o dump/example1.csv -r 0-100

-i — бинарный файл

-o — CSV дамп

-r — диапазон адресов памяти для дампа

Запуск Tkinter GUI
python uvm_gui.py

Позволяет:

редактировать JSON-программы

ассемблировать и запускать интерпретатор

просматривать дамп памяти

сохранять бинарники и дампы

Запуск Web GUI на Flask
pip install flask
python uvm_gui_web.py


Открыть в браузере: http://127.0.0.1:5000/

Позволяет:

редактировать JSON-программы

ассемблировать и запускать интерпретатор

видеть байткод, IR и дамп памяти

указывать диапазон дампа

Пример тестовой программы (max для векторов длины 5)

JSON-файл vector_max.json:

[	
    {"op": "load_const", "B": 10, "C": 200},
    {"op": "load_const", "B": 11, "C": 201},
    {"op": "load_const", "B": 12, "C": 202},
    {"op": "load_const", "B": 13, "C": 203},
    {"op": "max", "B": 14, "C": 10, "D": 11},
    {"op": "max", "B": 15, "C": 12, "D": 13}
]


Результат помещается в ячейки 14–15. Дамп CSV можно получить через интерпретатор или GUI.

Проверка работы

Загрузите JSON-программу в GUI (Tkinter или Web).

Укажите диапазон дампа памяти, например 0-20.

Нажмите Assemble & Run.

Убедитесь, что дамп совпадает с ожидаемыми результатами.

Сохраняйте бинарники и CSV дампы и проверяйте их через интерпретатор:

python uvm_interp.py -i dump/vector_max.bin -o dump/vector_max.csv -r 0-20

Примечания

Все бинарники и дампы создаются в папке dump/.

Web GUI использует папку templates/ для index.html.

JSON-программы должны использовать только допустимые команды: load_const, read_value, write_value, max.
